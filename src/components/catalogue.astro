---
import ContentSection from '~/components/content-section.astro';
import type { ClotheItem } from '~/types';
import Carousel from './carousel.svelte';
import clothesJson from "./../assets/data.json" assert { type: 'json' };

const clothes: Array<ClotheItem> = clothesJson.items;

const widths = [450, 800, 1200, 2000];
const sizes = '100vw';


type Image = {
	title: string;
	explanation: string;
	media_type: 'image' | 'video';
	/** Date published in YYYY-MM-DD format */
	date: string;
	/** Video URL or standard resolution image URL */
	url: string;
	/** High-res image URL (for media_type: 'image' only) */
	hdurl?: string;
	/** API version. Defaults to "v1" */
	service_version: string;
}
---

<ContentSection id="catalogue">
  <ul class="grid max-w-7xl grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4">
    {
      clothes.map(({ id, title, materials, size, price, discount, images }) => (
        <li class="flex flex-col items-start gap-4 rounded-lg border border-default bg-offset p-3">
          <Carousel client:load images={images}} />
          <!--
          <a href={`/item/${id}`}>
            <header class="text-center font-extrabold text-xl">{title}</header>
          </a>
          -->
          <header class="text-center font-extrabold text-xl">{title}</header>
          <section class="flex w-full justify-between space-x-4">
            <p class="text text-base">Materiales</p>
            <p class="truncate font-semibold text-offset text-base">
              {materials.join(',')}
            </p>
          </section>
          <section class="flex w-full justify-between">
            <p class="text text-base">Tallas</p>
            <p class="font-semibold text-offset text-base">{size}</p>
          </section>
          <section class="flex w-full space-x-2">
            <p
              class={`${
                discount ? 'line-through' : ''
              } font-bold text-currency text-base`}
            >
              PEN {price % 1 === 0 ? price + '.00' : price.toFixed(2)}
            </p>
            <p class="font-bold text-currencyDiscount text-base">
              {
                // add decimal places to the price if needed
                discount
                  ? ' - ' + (price - (price * discount) / 100).toFixed(2)
                  : ''
              }
            </p>
          </section>
          <button
            class="w-full rounded-full bg-accent px-4 py-2 font-bold text-accent hover:bg-blue-700"
            onclick="window.open('https://ig.me/m/melush_clothes', '_blank')"
            type="button"
            aria-label="Contact"
          >
            Contactar
          </button>
        </li>
      ))
    }
  </ul>
</ContentSection>
